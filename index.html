<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>韓国語4択クイズ</title>
<style>
body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #e0f7fa;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
#question {
  font-size: 36px;
  margin: 30px;
  text-align: center;
}
.choice-btn {
  display: block;
  width: 200px;
  font-size: 24px;
  margin: 10px;
  padding: 12px;
  border-radius: 12px;
  border: none;
  background: #81d4fa;
  color: #033;
  box-shadow: 0 3px 5px rgba(0,0,0,0.2);
}
.choice-btn:active {
  transform: scale(0.94);
}
#result {
  margin-top: 20px;
  font-size: 24px;
}
</style>
</head>
<body>

<div id="question">問題文</div>
<div id="choices">
  <button class="choice-btn" id="choice0"></button>
  <button class="choice-btn" id="choice1"></button>
  <button class="choice-btn" id="choice2"></button>
  <button class="choice-btn" id="choice3"></button>
</div>
<div id="result"></div>

<script>
let words = [];
let currentIndex = 0;

fetch("words.csv")
  .then(r => r.text())
  .then(text => {
    words = text.split("\n")
      .map(l => l.split(","))
      .filter(w => w[0]);
    startQuiz();
  });

function startQuiz() {
  currentIndex = 0;
  showQuestion();
}

function showQuestion() {
  if(currentIndex >= words.length) {
    document.getElementById("question").textContent = "終了！";
    document.getElementById("choices").style.display = "none";
    return;
  }

  let correct = words[currentIndex][1]; // 日本語
  document.getElementById("question").textContent = words[currentIndex][0]; // 韓国語

  // ランダムに3つの間違いを選ぶ
  let choices = [correct];
  while(choices.length < 4) {
    let rand = words[Math.floor(Math.random() * words.length)][1];
    if(!choices.includes(rand)) choices.push(rand);
  }

  // 配列をシャッフル
  choices = choices.sort(() => Math.random() - 0.5);

  for(let i=0;i<4;i++) {
    let btn = document.getElementById(`choice${i}`);
    btn.textContent = choices[i];
    btn.onclick = () => checkAnswer(choices[i], correct);
  }

  document.getElementById("result").textContent = "";
}

function checkAnswer(selected, correct) {
  if(selected === correct) {
    document.getElementById("result").textContent = "正解！";
  } else {
    document.getElementById("result").textContent = `不正解… 正解は ${correct}`;
  }
  currentIndex++;
  setTimeout(showQuestion, 1000);
}
</script>

</body>
</html>